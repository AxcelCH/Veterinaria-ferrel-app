<div class="pagos-container">
  <header class="pagos-header">
    <h1 class="pagos-title text-center">Detalles de pago</h1>
  </header>

  <section class="top-section">
    <div class="flex w-full flex-col items-center gap-4">
      <!-- Fila para ID de Orden de Pago -->
      <div class="flex w-full items-center justify-center gap-4">
        <div class="flex w-1/4 flex-col gap-2">
          <label for="orderId">ID de Orden de Pago</label>
          <p-autocomplete [(ngModel)]="id" [suggestions]="items" (completeMethod)="buscar($event)"
            (onSelect)="onSelectOrden($event.value)" field="idOrden" dropdown [forceSelection]="true"></p-autocomplete>
        </div>
        <div class="flex gap-2">
          <p-button label="Eliminar" icon="pi pi-trash" severity="danger" (onClick)="expirarorden()"
            [disabled]="!id"></p-button>
        </div>
      </div>
      <!-- Fila para Monto de la consulta -->
      <div class="flex w-full items-center justify-center gap-4">
        <div class="flex w-1/4 flex-col gap-2">
          <label for="consultaMonto">Monto de la consulta</label>
          <p-inputnumber [(ngModel)]="consulta" [useGrouping]="false" [min]="0" [max]="100"
            [maxFractionDigits]="2"></p-inputnumber>
          <small class="text-xs text-gray-500">Monto máximo de 100 soles</small>
        </div>
        <div class="flex gap-2">
          <p-button label="Agregar" icon="pi pi-search" severity="success" (onClick)="anadirConsulta()"></p-button>
          <p-button label="Eliminar" icon="pi pi-trash" severity="danger" (onClick)="eleminarConsulta()"
            [disabled]="pagoId.length == 0"></p-button>
        </div>
      </div>
    </div>
  </section>

  <section class="table-section mt-6">
    <p-table [value]="products" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Tipo</th>
          <th>Descripción</th>
          <th>Cantidad</th>
          <th>Precio total</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>{{ product.tipo }}</td>
          <td>{{ product.descripcion }}</td>
          <td>{{ product.cantidad }}</td>
          <td>{{ product.subtotal }}</td>
        </tr>
      </ng-template>
    </p-table>
  </section>

  <section class="summary-section mt-6">
    <div class="total-info flex items-center justify-between">
      <span class="total-label text-lg font-semibold">Monto total:</span>
      <span class="total-amount text-lg font-semibold">{{ monto }}</span>
    </div>
    <div class="action-button mt-4 flex justify-center">
      <p-button label="Confirmar pago" icon="pi pi-print" (onClick)="visiblePagar = true"
        [disabled]="!products.length"><i class="fa fa-shopping-cart" aria-hidden="true"></i></p-button>
    </div>
  </section>
</div>

<p-dialog header="Confirmar pago" [(visible)]="visiblePagar" [modal]="true" [style]="{ width: '80vw', height: 'auto' }">
  <div >
    <div class="flex items-center gap-4 mb-6">
      <label for="dni" class="font-semibold w-24">DNI</label>
      <input pInputText id="dni" [(ngModel)]="dni"  (ngModelChange)="validateDni()" maxlength="8" />
    </div>
    <div class="columns-1 gap-4 mb-4">
      <label class="font-bold">Resumen del carrito</label>
      <p-table [value]="products" [tableStyle]="{ 'min-width': '50rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th>Tipo</th>
            <th>Descripción</th>
            <th>Cantidad</th>
            <th>Precio total</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
          <tr>
            <td>{{ product.tipo }}</td>
            <td>{{ product.descripcion }}</td>
            <td>{{ product.cantidad }}</td>
            <td>{{ product.subtotal }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <div class="columns-1 gap-4 mb-6">
      <label class="font-bold">Metodo de pago</label>
      <label > Por implementar  <i class="fa fa-code-fork " aria-hidden="true"></i>
      </label>
    </div>

    <div class="p-field">
      <p-button label="Confirmar pago" icon="pi pi-check" (onClick)="confirmarPago()" [disabled]="dniError || !dni"><i class="fa fa-check" aria-hidden="true"></i>
</p-button>
    </div>
  </div>
</p-dialog>